---
layout: single
title: "JDBCì´í•´"
categories: [db1]
tags: [db1]
toc: true
author_profile: true
---

# â˜• Spring ê³µë¶€ ê¸°ë¡

## ğŸ“˜ í•™ìŠµ ë‚ ì§œ
- 2025-07-31

## ğŸ“… ì˜¤ëŠ˜ ë°°ìš´ ë‚´ìš©

### âœ¨1. JDBC

- JDBCëŠ” 1997ë…„ì— ì¶œì‹œëœ ì˜¤ë˜ëœ ê¸°ìˆ 
- JDBCë¥¼ ì§ì ‘ì ìœ¼ë¡œ ì‚¬ìš©í•˜ëŠ”ê²ƒë³´ë‹¤ëŠ” JDBCë¥¼ í¸ë¦¬í•˜ê²Œ ì‚¬ìš©í•˜ê²Œ í•´ì£¼ëŠ” SQL Mapper(JDBC template, MyBatis), ORM(JPA,í•˜ì´ë²„ë„¤ì´)ë“± ì‚¬ìš©

#### 1-1. SQL Mapper vs ORM

- SQL MapperëŠ” SQLë§Œ ì‘ì„± í•œë‹¤ë©´ ì‰½ê²Œ ì‚¬ìš© ê°€ëŠ¥
- ORMì€ SQLìì²´ë¥¼ ì‘ì„±í•˜ì§€ ì•Šì•„ë„ ë˜ê¸°ì— ê°œë°œ ìƒì‚°ì„± ë†’ì•„ì§, í¸ë¦¬í•œ ë°˜ë©´ ì‰¬ìš´ ê¸°ìˆ  ì•„ë‹ˆë¯€ë¡œ ê¹Šì´ìˆëŠ” í•™ìŠµ í•„ìš”

---
### âœ¨2. JDBC ì‚¬ìš©í•´ë³¸ ì½”ë“œë“¤

- JDBC ì‚¬ìš©í•˜ì—¬ ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²°
```java
public static Connection getConnection() {
try {
Connection connection = DriverManager.getConnection(URL, USERNAME,
PASSWORD);
log.info("get connection={}, class={}", connection,
connection.getClass());
return connection;
} catch (SQLException e) {
throw new IllegalStateException(e);
}
```

- íšŒì› ë“±ë¡
```java
public Member save(Member member) throws SQLException {
    String sql = "insert into member(member_id, money) values(?, ?)";
    Connection con = null;
    PreparedStatement pstmt = null;
    try {
        con = getConnection();
        pstmt = con.prepareStatement(sql);
        pstmt.setString(1, member.getMemberId());
        pstmt.setInt(2, member.getMoney());
        pstmt.executeUpdate();
        return member;
    } catch (SQLException e) {
        log.error("db error", e);
        throw e;
    } finally {
        close(con, pstmt, null);
    }
}

private void close(Connection con, Statement stmt, ResultSet rs) {
    if (rs != null) {
        try {
            rs.close();
        } catch (SQLException e) {
            log.info("error", e);
        }
    }
    if (stmt != null) {
        try {
            stmt.close();
        } catch (SQLException e) {
            log.info("error", e);
        }
    }
    if (con != null) {
        try {
            con.close();
        } catch (SQLException e) {
            log.info("error", e);
        }
    }
}

private Connection getConnection() {
    return DBConnectionUtil.getConnection();
}
```
- ì»¤ë„¥ì…˜ íšë“ -> ë“±ë¡ sqlì •ì˜(insert)
- con.prepareStatement(sql) : ë°ì´í„°ë² ì´ìŠ¤ì— ì „ë‹¬í•  SQLê³¼ íŒŒë¼ë¯¸í„°ë¡œ ì „ë‹¬í•  ë°ì´í„°ë“¤ ì¤€ë¹„
- pstmt.setString(1,member.getMemberId()) : SQLì˜ ì²«ë²ˆì§¸ ?ì— ê°’ì„ ì§€ì •
- excuteUpdate() : Statementë¥¼ í†µí•´ ì¤€ë¹„ëœ SQLì„ ì»¤ë„¥ì…˜ í†µí•˜ì—¬ ë°ì´í„°ë² ì´ìŠ¤ì— ì „ë‹¬, ì˜í–¥ë°›ì€ DB row ìˆ˜ ë°˜í™˜ 
- ë¦¬ì†ŒìŠ¤ ì •ë¦¬ëŠ” ì—­ìˆœìœ¼ë¡œ pstmt -> con

- íšŒì› ì¡°íšŒ

```java
public Member findById(String memberId) throws SQLException {
    String sql = "select * from member where member_id = ?";
    Connection con = null;
    PreparedStatement pstmt = null;
    ResultSet rs = null;
    try {
        con = getConnection();
        pstmt = con.prepareStatement(sql);
        pstmt.setString(1, memberId);
        rs = pstmt.executeQuery();
        if (rs.next()) {
            Member member = new Member();
            member.setMemberId(rs.getString("member_id"));
            member.setMoney(rs.getInt("money"));
            return member;
        } else {
            throw new NoSuchElementException("member not found memberId=" +
                    memberId);
        }
    } catch (SQLException e) {
        log.error("db error", e);
        throw e;
    } finally {
        close(con, pstmt, rs);
    }
}
```

- rs : ë°ì´í„°ë¥¼ ë³€ê²½í• ë•ŒëŠ” excuteUpdate() ì‚¬ìš©í•˜ì§€ë§Œ ë°ì´í„°ë¥¼ ì¡°íšŒ í•  ë•ŒëŠ” excuteQuery() ì‚¬ìš©, ì´ëŠ” ê²°ê³¼ë¥¼ ResultSetì— ë‹´ì•„ì„œ ë°˜í™˜í•´ì¤Œ.
- ResultSet : select ì¿¼ë¦¬ì˜ ê²°ê³¼ê°€ ìˆœì„œëŒ€ë¡œ ë“¤ì–´ê°.
- ë‚´ë¶€ì— ìˆëŠ” ì»¤ì„œë¥¼ ì´ë™í•˜ì—¬ ë‹¤ìŒ ë°ì´í„° ì¡°íšŒ
- rs.next() : ìµœì´ˆì˜ ì»¤ì„œëŠ” ë°ì´í„°ë¥¼ ê°€ë¦¬í‚¤ê³  ìˆì§€ ì•Šê¸°ì— rs.next()í˜¸ì¶œ ìµœì†Œ í•œ ë²ˆì€ í•´ì•¼í•¨. trueë©´ ë°ì´í„° ìˆë‹¤ëŠ” ê²ƒ, falseë©´ ë” ì´ìƒ ì»¤ì„œê°€ ê°€ë¦¬í‚¤ëŠ” ë°ì´í„° X
- rs.getString("member_id") : í˜„ì¬ ì»¤ì„œê°€ ê¸°ë¦¬í‚¤ê³  ìˆëŠ” ìœ„ì¹˜ì˜ member_id ë°ì´í„°ë¥¼ String íƒ€ì…ìœ¼ë¡œ ë°˜í™˜í•¨.

- ìˆ˜ì • ë° ì‚­ì œë„ ì´ëŸ°ì‹ìœ¼ë¡œ ë™ì‘í•¨.