---
layout: single
title: "ì»¤ë„¥ì…˜ í’€ê³¼ ë°ì´í„°ì†ŒìŠ¤ ì´í•´"
categories: [db1]
tags: [db1]
toc: true
author_profile: true
---

# â˜• Spring ê³µë¶€ ê¸°ë¡

## ğŸ“˜ í•™ìŠµ ë‚ ì§œ
- 2025-08-01

## ğŸ“… ì˜¤ëŠ˜ ë°°ìš´ ë‚´ìš©

### âœ¨ 1. ì»¤ë„¥ì…˜ í’€ ì´í•´ (ê°œë…ì ìœ¼ë¡œ ìŠ¤ë ˆë“œ í’€ê³¼ ê°™ë‹¤ëŠ” ìƒê°ì´ ë“¦)

- ë°ì´í„°ë² ì´ìŠ¤ ì»¤ë„¥ì…˜ íšë“ ì‹œ ë³µì¡í•œ ê³¼ì • ê±°ì¹¨ 
- DBë“œë¼ì´ë²„ê°€ DBì™€ TCP/IP í†µì‹ , handshakeê°™ì€ ë„¤íŠ¸ì›Œí¬ ë™ì‘ ë°œìƒ
- ê·¸ ë’¤ì— ë” ë§ì€ ê³¼ì • ë°œìƒ
  - ì• í”Œë¦¬ì¼€ì´ì…˜ ì„œë²„ì—ì„œë„ TCP/IP ì»¤ë„¥ì…˜ì„ ìƒˆë¡œ ìƒì„±í•˜ê¸°  ìœ„í•œ ë¦¬ì†ŒìŠ¤ ë§¤ë²ˆ ì‚¬ìš©ë˜ì•¼í•¨
  - ê³ ê°ì´ ì• í”Œë¦¬ì¼€ì´ì…˜ ì‚¬ìš©í•  ë•Œ, SQLì‹¤í–‰ ì‹œê°„ ë¿ ì•„ë‹ˆë¼ ì»¤ë„¥ì…˜ ìƒˆë¡œ ë§Œë“œëŠ” ì‹œê°„ ì¶”ê°€ë˜ì–´ ì‘ë‹µ ì†ë„ì— ì˜í–¥
- í•´ê²°í•˜ê¸° ìœ„í•´ ì»¤ë„¥ì…˜ì„ ë¯¸ë¦¬ ìƒì„±í•´ë‘ê³  ì‚¬ìš©í•˜ëŠ” ì»¤ë„¥ì…˜ í’€ ì‚¬ìš©
- ê¸°ë³¸ê°’ì€ ë³´í†µ 10ê°œì˜ ì»¤ë„¥ì…˜ë“¤ ì»¤ë„¥ì…˜ í’€ì— ìƒì„±í•´ë‘ .
- ì‹¤ë¬´ì—ì„œëŠ” í•­ìƒ ê¸°ë³¸ìœ¼ë¡œ ì‚¬ìš©
- ì»¤ë„¥ì…˜ í’€ ì§ì ‘ êµ¬í˜„í•˜ê¸°ë³´ë‹¤ëŠ” ì˜¤í”ˆì†ŒìŠ¤ ì»¤ë„¥ì…˜ í’€ ì‚¬ìš© (HikariCP)
---

### âœ¨ 2. DataSource ì´í•´

- ì• í”Œë¦¬ì¼€ì´ì…˜ ë¡œì§ì—ì„œ DriverManagerì„ í†µí•´ ì»¤ë„¥ì…˜ì„ íšë“í•˜ë‹¤ê°€, HikariCP ê°™ì€ ì»¤ë„¥ì…˜ í’€ ì‚¬ìš©í•˜ë„ë¡ ë³€ê²½í•˜ë©´ ì»¤ë„¥ì…˜ íšë“í•˜ëŠ” ì• í”Œë¦¬ì¼€ì´ì…˜ ì½”ë“œë„ í•¨ê»˜ ë³€ê²½í•´ì•¼í•¨.
- ì´ëŸ° ë¬¸ì œ í•´ê²°í•˜ê¸° ìœ„í•´ DataSourceë¼ëŠ” ì¸í„°í˜ì´ìŠ¤ ì œê³µ
- **ì»¤ë„¥ì…˜ì„ íšë“í•˜ëŠ” ë°©ë²•ì„ ì¶”ìƒí™” í•˜ëŠ” ì¸í„°í˜ì´ìŠ¤**
- DataSourceë¥¼ ì‚¬ìš©í•˜ì—¬ ì»¤ë„¥ì…˜ì„ íšë“í•  ë•Œì—ëŠ” ì„¤ì •ê³¼ ì‚¬ìš©ì˜ ë¶„ë¦¬ê°€ ë˜ì–´ìˆë‹¤.
- DataSourceë¥¼ ì‚¬ìš©í•  ë•Œì—ëŠ” í•„ìš”í•œ ì†ì„± ìƒì„±ì‹œì ì— ë„£ì–´ë†“ê³ , ì‚¬ìš©í•  ë•Œì—ëŠ” getConnection() ë§Œ í˜¸ì¶œí•´ì„œ ì‚¬ìš©í•¨

```markdown
DriverManager.getConnection(URL, USERNAME, PASSWORD)
DriverManager.getConnection(URL, USERNAME, PASSWORD)
------------------------------------------------------------------------------
void dataSourceDriverManager() throws SQLException {
DriverManagerDataSource dataSource = new DriverManagerDataSource(URL,
USERNAME, PASSWORD);
useDataSource(dataSource);
}
private void useDataSource(DataSource dataSource) throws SQLException {
Connection con1 = dataSource.getConnection();
Connection con2 = dataSource.getConnection();
log.info("connection={}, class={}", con1, con1.getClass());
log.info("connection={}, class={}", con2, con2.getClass());
}
```
- ì½”ë“œì‚¬ìš© ì˜ˆì œë¥¼ ë¶€ë©´ ì•Œ ìˆ˜ ìˆë“¯ì´ ì„¤ì •ê³¼ ì‚¬ìš©ì´ ë¶„ë¦¬ë˜ì–´ìˆìŒ.
- ì• í”Œë¦¬ì¼€ì´ì…˜ì—ì„œ ì ìš©í•´ë³´ë©´, DataSourceë¥¼ ì™¸ë¶€ì—ì„œ ì£¼ì…ë°›ì•„ ì‚¬ìš©í•˜ë©´ ë˜ê¸°ë•Œë¬¸ì— ë¶ˆí•„ìš”í•œ ì½”ë“œ ë³€ê²½ ì—†ì–´ë„ ëœë‹¤.
- ê·¸ëƒ¥ DataSource ì¸í„°í˜ì´ìŠ¤ì— ì˜ì¡´í•˜ê¸°ë§Œ í•˜ë©´ ë‚˜ëŠ” ë¬´ìŠ¨ DataSourceë¥¼ ì£¼ì…ë°›ì•˜ëŠ”ì§€ ëª°ë¼ë„ ì‚¬ìš©ì´ ê°€ëŠ¥í•˜ë‹¤.
- DI : DriverManagerDataSource -> HikariDataSourceë¡œ ë³€ê²½í•´ë„ MemberRepositoryV1ì˜ ì½”ë“œëŠ” ì „í˜€ ë³€í•˜ì§€ ì•Šì•„ë„ ëœë‹¤.
- DataSource ì¸í„°í˜ì´ìŠ¤ì—ë§Œ ì˜ì¡´í•˜ê¸° ë•Œë¬¸ (DI + OCP)

```java
public class MemberRepositoryV1 {

    private final DataSource dataSource;

    public MemberRepositoryV1(DataSource dataSource) {
        this.dataSource = dataSource;
    }
```

```java
 @BeforeEach
void beforeEach() {

//        DriverManagerDataSource dataSource = new DriverManagerDataSource(URL, USERNAME, PASSWORD);

//        repository = new MemberRepositoryV1(dataSource);

  HikariDataSource dataSource = new HikariDataSource();
  dataSource.setJdbcUrl(URL);
  dataSource.setUsername(USERNAME);
  dataSource.setPassword(PASSWORD);
  repository = new MemberRepositoryV1(dataSource);
}
```

- ì´ë ‡ê²Œ ì˜ì¡´ì„± ì£¼ì…ì„ í†µí•´ ì½”ë“œ ë³€ê²½ ì—†ì´ ì‚¬ìš© ê°€ëŠ¥
---
#### 2-1. JdbcUtils í¸ì˜ ë©”ì„œë“œ
- JdbcUtilsë¥¼ ì‚¬ìš©í•˜ë©´ ì»¤ë„¥ì…˜ì„ ì¢€ ë” í¸ë¦¬í•˜ê²Œ ë‹«ì„ ìˆ˜ ìˆìŒ.

```java
private void close(Connection con, Statement stmt, ResultSet rs) {

    JdbcUtils.closeResultSet(rs);
    JdbcUtils.closeStatement(stmt);
    JdbcUtils.closeConnection(con);
}
```