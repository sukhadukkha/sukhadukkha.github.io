---
layout: single
title: "ì˜ˆì™¸ ì²˜ë¦¬ì™€ ì˜¤ë¥˜ í˜ì´ì§€"
categories: [mvc2]
tags: [mvc2, TIL]
toc: true
author_profile: true
---

# â˜• Spring ê³µë¶€ ê¸°ë¡

## ğŸ“˜ í•™ìŠµ ë‚ ì§œ
- 2025-07

## ğŸ“… ì˜¤ëŠ˜ ë°°ìš´ ë‚´ìš©

### 1. ì„œë¸”ë¦¿ ì˜ˆì™¸ ì²˜ë¦¬ - ì˜¤ë¥˜ í˜ì´ì§€ ì‘ë™ ì›ë¦¬

- ì˜ˆì™¸ ë°œìƒ íë¦„ WAS(ì—¬ê¸°ê¹Œì§€ ì „íŒŒ) <- í•„í„° <- ì„œë¸”ë¦¿ <- ì¸í„°ì…‰í„° <- ì»¨íŠ¸ë¡¤ëŸ¬(ì˜ˆì™¸ë°œìƒ)

ì˜ˆë¥¼ë“¤ì–´ RuntimeException ì˜ˆì™¸ê°€ WASê¹Œì§€ ì „ë‹¬ë˜ë©´, WASëŠ” ì˜¤ë¥˜í˜ì´ì§€ ì •ë³´ë¥¼ í™•ì¸í•˜ê³ , ì˜¤ë¥˜í˜ì´ì§€ë¡œ /error-page/500ì´ ì§€ì •ë˜ì–´ ìˆë‹¤ë©´ WASëŠ” /error-page/500ì„ ë‹¤ì‹œ ìš”ì²­í•œë‹¤.

- ì˜¤ë¥˜í˜ì´ì§€ ìš”ì²­ íë¦„ WAS '/error-page/500' ë‹¤ì‹œ ìš”ì²­ -> í•„í„° -> ì„œë¸”ë¦¿ -> ì¸í„°ì…‰í„° -> ì»¨íŠ¸ë¡¤ëŸ¬(/error-page/500) -> view

**ì›¹ ë¸Œë¼ìš°ì €(í´ë¼ì´ì–¸íŠ¸)ëŠ” ì„œë²„ ë‚´ë¶€ì—ì„œ ì´ëŸ° íë¦„ ì¼ì–´ë‚˜ëŠ”ì§€ ì „í˜€ ëª¨ë¦„. ì˜¤ì§ ì„œë²„ ë‚´ë¶€ì—ì„œ ì˜¤ë¥˜ í˜ì´ì§€ë¥¼ ì°¾ê¸° ìœ„í•´ ì¶”ê°€ì ì¸ í˜¸ì¶œ ì‹¤í–‰**

#### 1-1. ì„œë¸”ë¦¿ ì˜ˆì™¸ ì²˜ë¦¬ - í•„í„°

ì˜¤ë¥˜ê°€ ë°œìƒí•˜ë©´ ì˜¤ë¥˜ í˜ì´ì§€ë¥¼ ì¶œë ¥í•˜ê¸° ìœ„í•´ WASì—ì„œ ë‹¤ì‹œ í•œë²ˆ í˜¸ì¶œ ë°œìƒ. ì´ë•Œ í•„í„°, ì„œë¸”ë¦¿, ì¸í„°ì…‰í„°ë„ ëª¨ë‘ ë‹¤ì‹œ í˜¸ì¶œëœë‹¤.
í•˜ì§€ë§Œ ë¡œê·¸ì¸ ì¸ì¦ ì²´í¬ ê°™ì€ ê²½ìš°, ì´ë¯¸ í•„í„°ë‚˜ ì¸í„°ì…‰í„°ì—ì„œ ë¡œê·¸ì¸ ì²´í¬ë¥¼ ì™„ë£Œí–ˆê³ , ì´ëŸ´ ë•Œ, í•´ë‹¹ í•„í„°, ì¸í„°ì…‰í„°ê°€ í•œë²ˆ ë” í˜¸ì¶œë˜ëŠ” ê²ƒì€ ë¹„íš¨ìœ¨ì  <br>
ì´ë¥¼ í•´ê²°í•˜ê¸° ìœ„í•´ í´ë¼ì´ì–¸íŠ¸ë¡œ ë¶€í„° ë°œìƒí•œ ì •ìƒ ìš”ì²­ì¸ì§€, ì•„ë‹ˆë©´ ì˜¤ë¥˜ í˜ì´ì§€ë¥¼ ì¶œë ¥í•˜ê¸° ìœ„í•œ ë‚´ë¶€ ìš”ì²­ì¸ì§€ êµ¬ë¶„í•  ìˆ˜ ìˆê²Œ í•˜ëŠ” DispatcherTypeì´ë¼ëŠ” ì¶”ê°€ ì •ë³´ ì œê³µ


#### 1-2. DispatcherType

- ê³ ê°ì´ ì²˜ìŒ ìš”ì²­í•˜ë©´ dispatcherType = REQUESTì´ë‹¤. 
- REQUEST - í´ë¼ì´ì–¸íŠ¸ì˜  ìš”ì²­
- ERROR - ì˜¤ë¥˜ ìš”ì²­
- FORWARD - ì„œë¸”ë¦¿ì—ì„œ ë‹¤ë¥¸ ì„œë¸”ë¦¿ì´ë‚˜ JSPë¥¼ í˜¸ì¶œ í•  ë•Œ
- INCLUDE - ì„œë¸”ë¦¿ì—ì„œ ë‹¤ë¥¸ ì„œë¸”ë¦¿ì´ë‚˜ JSPì˜ ê²°ê³¼ í¬í•¨í•  ë•Œ
- ASYNC - ì„œë¸”ë¦¿ ë¹„ë™ê¸° í˜¸ì¶œ

**ì „ì²´ íë¦„ ì •ë¦¬** ì½”ë“œëŠ” Githubì— ì •ë¦¬í•´ë‘ .
1. WAS(/error-ex, dispatchType=REQUEST) -> í•„í„° -> ì„œë¸”ë¦¿ -> ì¸í„°ì…‰í„° -> ì»¨íŠ¸ë¡¤ëŸ¬
2. WAS(ì—¬ê¸°ê¹Œì§€ ì „íŒŒ) <- í•„í„° <- ì„œë¸”ë¦¿ <- ì¸í„°ì…‰í„° <- ì»¨íŠ¸ë¡¤ëŸ¬(ì˜ˆì™¸ë°œìƒ)
3. WAS ì˜¤ë¥˜ í˜ì´ì§€ í™•ì¸
4. WAS(/error-page/500, dispatchType=ERROR) -> í•„í„°(x) -> ì„œë¸”ë¦¿ -> ì¸í„°ì…‰í„°(x) -> ì»¨íŠ¸ë¡¤ëŸ¬(/error-page/500) -> View

### 2. ìŠ¤í”„ë§ ë¶€íŠ¸ - ì˜¤ë¥˜ í˜ì´ì§€

ìŠ¤í”„ë§ ë¶€íŠ¸ëŠ” ì´ëŸ° ê³¼ì •ì„ ëª¨ë‘ ê¸°ë³¸ìœ¼ë¡œ ì œê³µ
ErrorPageë¥¼ ìë™ìœ¼ë¡œ ë“±ë¡í•˜ê³ , /errorë¼ëŠ” ê²½ë¡œë¡œ ê¸°ë³¸ ì˜¤ë¥˜ í˜ì´ì§€ ì„¤ì •

**ê°œë°œìëŠ” ì˜¤ë¥˜í˜ì´ì§€ë§Œ ë“±ë¡í•˜ë©´ ëœë‹¤.**
HTMLì´ë©´ ì •ì  ë¦¬ì†ŒìŠ¤, ë·° í…œí”Œë¦¿ì„ ì‚¬ìš©í•´ì„œ ë™ì ìœ¼ë¡œ ì˜¤ë¥˜ í™”ë©´ ë§Œë“¤ê³  ì‹¶ìœ¼ë©´ ë·° í…œí”Œë¦¿ ê²½ë¡œì— ì˜¤ë¥˜ í˜ì´ì§€ íŒŒì¼ì„ ë§Œë“¤ì–´ì„œ ë„£ì–´ë‘ê¸°ë§Œ í•˜ë©´ ë¨.

---

BasicErrorControllerì˜ ì²˜ë¦¬ ìˆœì„œ

1. ë·° í…œí”Œë¦¿
   `resources/templates/error/500.html`
   `resources/templates/error/5xx.html`
2. ì •ì  ë¦¬ì†ŒìŠ¤(`static` , `public` )
   `resources/static/error/400.html`
   `resources/static/error/404.html`
   `resources/static/error/4xx.html`
3. ì ìš© ëŒ€ìƒì´ ì—†ì„ ë•Œ ë·° ì´ë¦„(`error` )
   `resources/templates/error.html`

---

### 3. API ì˜ˆì™¸ ì²˜ë¦¬

HTML í˜ì´ì§€ì˜ ê²½ìš° ì§€ê¸ˆê¹Œì§€ ì„¤ëª…í–ˆë˜ ê²ƒ ì²˜ëŸ¼ 4xx,5xx ë“± ì˜¤ë¥˜í˜ì´ì§€ë§Œ ìˆìœ¼ë©´ ëŒ€ë¶€ë¶„ ë¬¸ì œ í•´ê²°
APIì˜ ê²½ìš°ì—ëŠ” ì˜¤ë¥˜ ìƒí™©ì— ë§ëŠ” ì˜¤ë¥˜ ì‘ë‹µ ìŠ¤í™ ê²°ì •í•˜ê³ , JSONìœ¼ë¡œ ë°ì´í„°ë¥¼ ë‚´ë ¤ì£¼ì–´ì•¼í•¨.

**ìŠ¤í”„ë§ì€ API ì˜ˆì™¸ ì²˜ë¦¬ ë¬¸ì œë¥¼ í•´ê²°í•˜ê¸° ìœ„í•´ @ExceptionHandlerë¼ëŠ” ì• ë…¸í…Œì´ì…˜ì„ ì‚¬ìš©í•˜ëŠ” ë§¤ìš° í¸ë¦¬í•œ ì˜ˆì™¸ ì²˜ë¦¬ ê¸°ëŠ¥ ì œê³µ**
ì´ê²ƒì´ ë°”ë¡œ `ExceptionHandlerExceptionResolver`ì´ë‹¤. ì´ëŠ” ê¸°ë³¸ìœ¼ë¡œ ì œê³µí•˜ëŠ” `ExceptionResolver` ì¤‘ì— ìš°ì„  ìˆœìœ„ë„ ê°€ì¥ ë†’ë‹¤.

**@ExceptionHandler ì˜ˆì™¸ ì²˜ë¦¬ ë°©ë²•**
`@ExceptionHandler` ì• ë…¸í…Œì´ì…˜ì„ ì„ ì–¸í•˜ê³ , í•´ë‹¹ ì»¨íŠ¸ë¡¤ëŸ¬ì—ì„œ ì²˜ë¦¬í•˜ê³  ì‹¶ì€ ì˜ˆì™¸ë¥¼ ì§€ì •í•´ì£¼ë©´ ëœë‹¤. í•´ë‹¹ ì»¨
íŠ¸ë¡¤ëŸ¬ì—ì„œ ì˜ˆì™¸ê°€ ë°œìƒí•˜ë©´ ì´ ë©”ì„œë“œê°€ í˜¸ì¶œëœë‹¤. ì°¸ê³ ë¡œ ì§€ì •í•œ ì˜ˆì™¸ ë˜ëŠ” ê·¸ ì˜ˆì™¸ì˜ ìì‹ í´ë˜ìŠ¤ëŠ” ëª¨ë‘ ì¡ì„ ìˆ˜ ìˆ
ë‹¤.

ì˜ˆì œ
llegalArgumentException ì²˜ë¦¬
```java
@GetMapping("/api2/members/{id}")
public MemberDto getMember(@PathVariable("id") String id) {
if (id.equals("ex")) {
throw new RuntimeException("ì˜ëª»ëœ ì‚¬ìš©ì");
}
if (id.equals("bad")) {
throw new IllegalArgumentException("ì˜ëª»ëœ ì…ë ¥ ê°’");
}
if (id.equals("user-ex")) {
throw new UserException("ì‚¬ìš©ì ì˜¤ë¥˜");
}
return new MemberDto(id, "hello " + id);
}
```
```java
@ResponseStatus(HttpStatus.BAD_REQUEST)
@ExceptionHandler(IllegalArgumentException.class)
public ErrorResult illegalExHandle(IllegalArgumentException e) {
log.error("[exceptionHandle] ex", e);
return new ErrorResult("BAD", e.getMessage());
}
```

ê²°ê³¼ 
```json
{
"code": "BAD",
"message": "ì˜ëª»ëœ ì…ë ¥ ê°’"
}
```

**ì‹¤í–‰ íë¦„**
- ì»¨íŠ¸ë¡¤ëŸ¬ë¥¼ í˜¸ì¶œí•œ ê²°ê³¼ `IllegalArgumentException` ì˜ˆì™¸ê°€ ì»¨íŠ¸ë¡¤ëŸ¬ ë°–ìœ¼ë¡œ ë˜ì ¸ì§„ë‹¤.
- ì˜ˆì™¸ê°€ ë°œìƒí–ˆìœ¼ë¡œ `ExceptionResolver` ê°€ ì‘ë™í•œë‹¤. ê°€ì¥ ìš°ì„ ìˆœìœ„ê°€ ë†’ì€ `ExceptionHandlerExceptionResolver` ê°€ ì‹¤í–‰ëœë‹¤. 
- `ExceptionHandlerExceptionResolver` ëŠ” í•´ë‹¹ ì»¨íŠ¸ë¡¤ëŸ¬ì— `IllegalArgumentException` ì„ ì²˜ë¦¬ í•  ìˆ˜ ìˆëŠ” `@ExceptionHandler` ê°€ ìˆëŠ”ì§€ í™•ì¸í•œë‹¤.
- `illegalExHandle()` ë¥¼ ì‹¤í–‰í•œë‹¤. `@RestController` ì´ë¯€ë¡œ `illegalExHandle()` ì—ë„ `@ResponseBody` ê°€ ì ìš©ëœë‹¤. ë”°ë¼ì„œ HTTP ì»¨ë²„í„°ê°€ ì‚¬ìš©ë˜ê³ , ì‘ë‹µì´ ë‹¤ìŒê³¼ ê°™ì€ JSONìœ¼ë¡œ ë°˜í™˜ëœë‹¤.
- `@ResponseStatus(HttpStatus.BAD_REQUEST)` ë¥¼ ì§€ì •í–ˆìœ¼ë¯€ë¡œ HTTP ìƒíƒœ ì½”ë“œ 400ìœ¼ë¡œ ì‘ë‹µí•œë‹¤.


--- 

@ControllerAdvice ë˜ëŠ” @RestControllerAdviceë¥¼ ì‚¬ìš©í•˜ë©´ ì •ìƒ ì½”ë“œì™€ ì˜ˆì™¸ ì²˜ë¦¬ ì½”ë“œë¥¼ ë¶„ë¦¬í•  ìˆ˜ ìˆë‹¤.

```java
@Slf4j
@RestControllerAdvice
public class ExControllerAdvice {
@ResponseStatus(HttpStatus.BAD_REQUEST)
@ExceptionHandler(IllegalArgumentException.class)
public ErrorResult illegalExHandle(IllegalArgumentException e) {
log.error("[exceptionHandle] ex", e);
return new ErrorResult("BAD", e.getMessage());
}
@ExceptionHandler
public ResponseEntity<ErrorResult> userExHandle(UserException e) {
log.error("[exceptionHandle] ex", e);
ErrorResult errorResult = new ErrorResult("USER-EX", e.getMessage());
return new ResponseEntity<>(errorResult, HttpStatus.BAD_REQUEST);
}
@ResponseStatus(HttpStatus.INTERNAL_SERVER_ERROR)
@ExceptionHandler
public ErrorResult exHandle(Exception e) {
log.error("[exceptionHandle] ex", e);
return new ErrorResult("EX",
"ë‚´ë¶€ ì˜¤ë¥˜");
}
}
```

```java
@Slf4j
@RestController
public class ApiExceptionV2Controller {
@GetMapping("/api2/members/{id}")
public MemberDto getMember(@PathVariable("id") String id) {
if (id.equals("ex")) {
throw new RuntimeException("ì˜ëª»ëœ ì‚¬ìš©ì");
}
if (id.equals("bad")) {
throw new IllegalArgumentException("ì˜ëª»ëœ ì…ë ¥ ê°’");
}
if (id.equals("user-ex")) {
throw new UserException("ì‚¬ìš©ì ì˜¤ë¥˜");
}
return new MemberDto(id, "hello " + id);
}
@Data
@AllArgsConstructor
static class MemberDto {
private String memberId;
private String name;
}
}
```

