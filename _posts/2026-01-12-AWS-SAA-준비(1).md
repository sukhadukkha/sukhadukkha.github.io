---
layout: single
title:  "AWS SAA 준비(IAM, MFA, AWS CLI, CloudShell)"
categories: [AWS SAA]
tags: [AWS SAA]
toc: true
author_profile: true
---
## 정리 개요

- AWS SAA를 취득하기 위해 Udemy에서 강의를 듣고 실습을 따라해보고 배운 내용을 정리한다.

## IAM(Identity and Access Management)

- AWS 리소스에 대한 인증과 권한을 중앙에서 관리하는 서비스.
- 누가 어떤 리소스에 어떤 작업을 할 수 있는지를 정의하고 제어한다.
- AWS를 처음 시작할 때 생성하는 Root 계정은 모든 권한을 가진 계정
- 일상적인 작업은 IAM을 통해 생성한 사용자를 사용하는 것이 기본이다.
- IAM은 지역을 선택할 수 없는 글로벌 서비스
- 사용자 만들기
- admin 그룹 생성
- IAM User 만들고 로그인해보기
- IAM Policy(정책) JSON 예시

```json
{
  "Version": "2012-10-17",
  "Statement": [ 
    {
      "Effect": "Allow", 
      "Action": [ 
        "s3:ListBucket", 
        "s3:GetObject"   
      ],
      "Resource": [ 
        "arn:aws:s3:::my-example-bucket",  
        "arn:aws:s3:::my-example-bucket/*" 
      ]
    }
  ]
}
```

- 만약 admin 그룹에서 jiho를 삭제하면 사용자를 볼 수 있는 권한을 잃는다.
- 다시 권한을 줄 때, IAMReadOnlyAccess 권한을 줌으로써 IAM의 모든 것을 볼 수 있게 되었다.

### MFA(Multi-Factor Authentication)

- 루트 계정과 모든 IAM 사용자를 보호하는 방법
- MFA는 암호정책보다 뛰어난 보안 장치
  - 암호정책 편집 가능
- 가상 MFA 장치(Google Authenticator, Authy...)
- FIDO 보안 키 (생체인증, YubiKey와 같은 물리적 USB 보안 키)
- 하드웨어 TOTP 토큰 (일정한 시간마다 6자리 번호를 붙여주는 물리적 전용 기기)

### 멀티세션

- 하나의 브라우줘에서 여러 AWS 계정에 동시에 로그인 할 수 있게 해준다.
- 이전처럼 계정 전환을 위해 로그아웃-로그인을 반복하거나, 여러 개의 브라우저 프로필 또는 시크릿 창을 띄울 필요가 없어 운영 효율이 매우 높다.

---

## AWS에 액세스 하는 방법

- 콘솔 
- CLI
- SDK
- Access Key 발급(공유 X)

### AWS CLI 설치, 자격 증명하기

- 나는 맥북을 사용하므로 맥에서 설치했다.
- brew install awscli
- aws --version으로 설치 확인
- 사용자 -> jiho -> 보안 자격 증명 -> 액세스 키 만들기
- aws configure 명령 통해, Access Key ID, Secret access key 입력
- Default region name에 서울 입력(ap-northeast-2), Default output format에서 그냥 enter 입력
- `aws iam list-users` 명령 통해 계정의 모든 사용자 출력 가능
- 콘솔에서 jiho의 권한을 제거하고, 다시 aws iam list-users 명령을 입력하면 출력이 되지 않는다.
- cli 사용 권한은 콘솔에서의 권한과 똑같다.

--- 

## AWS CloudShell

- CloudShell은 AWS 클라우드의 터미널이다.
- 사용 가능한 지역, 불가능한 지역들이 있다.
- 터미널에서 AWS CLI를 사용해도 된다.
- 파일 업로드, 다운로드가 가능하다.

---

## IAM Roles 

- 서버/서비스 간 권한 부여, 임시 권한 획득에 사용한다.
- ex) EC2 인스턴스가 다른 AWS 리소스(S3 등)에 접근할 때 접근할 수 있는 IAM Role이 필요하다.


## IAM Security Tools 

- AWS는 AWS는 강력한 감사 및 분석 도구인 Access Advisor와 자격 증명 보고서(Credential Report)를 제공한다.
- IAM Access Advisor
  - 이 도구는 "사용자가 부여받은 권한 중 실제로 무엇을 쓰고 있는가?"를 확인하는 데 사용된다.
  - 특정 IAM 사용자나 역할이 각 서비스(S3, EC2 등)에 마지막으로 접근한 시간을 보여준다.
  - 용도: 사용하지 않는 권한 제거. 예를 들어, 어떤 사용자에게 S3와 RDS 권한을 줬는데, Access Advisor를 보니 S3는 매일 쓰지만 RDS는 6개월간 한 번도 안 썼다면 RDS 권한을 회수하여 보안 사고 위험을 줄일 수 있다.
  - 확인 단위: 사용자별, 그룹별, 역할별로 상세히 확인 가능하다. (보통 최근 400일간의 데이터를 제공)
- 자격 증명 보고서 (Credential Report)
  - 이 도구는 "우리 계정의 전체적인 보안 상태(비밀번호, MFA 등)는 어떠한가?"를 점유율 관점에서 확인하는 보고서다.
  - 핵심 기능: 계정 내 모든 사용자의 상태를 담은 CSV 파일을 다운로드 할 수 잇다.
  - 포함 정보: 사용자 생성 날짜 및 비밀번호 변경일, MFA 활성화 여부, Access Key의 마지막 사용일 및 교체 주기
  - 용되 정기 보안 감사, 보안 담당자가 MFA를 안한 직원, 퇴사자인데 액세스 키가 아직 살아있는 계정 등을 파악할 때 사용한다.


## 스스로 정리하기

- 하나의 루트 계정에서 여러개의 IAM 유저를 만들 수 있다.
- 이 개별 IAM 유저를 만들고, 회사의 사람에게 매핑해주어 전달해줄 수 있다.
- 이 IAM 유저를 그룹으로 묶고, 권한을 줄 수 있다.
