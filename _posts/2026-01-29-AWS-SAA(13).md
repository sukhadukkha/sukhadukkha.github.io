---
layout: single
title:  "AWS SAA 준비(DynamoDB, API Gateway, Cognito, DocumentDB, Neptune, Keyspaces)"
categories: [AWS SAA]
tags: [AWS SAA]
toc: true
author_profile: true
---


## Amazon DynamoDB

- Amazon DynamoDB는 AWS에서 제공하는 완전 관리형 NoSQL 데이터베이스 서비스다. 키-값(Key-Value) 및 문서(Document) 데이터 모델을 지원하며, 규모에 관계없이 10밀리초 미만의 지연 시간(Single-digit millisecond)을 제공하는 것이 가장 큰 특징이다.
- 데이터 모델 및 구조
  - DynamoDB의 데이터 구조는 관계형 데이터베이스(RDS)와는 상이하다.
  - Table (테이블): 데이터의 집합체다.
  - Item (항목): RDS의 행(Row)에 해당한다. 항목 간 속성이 달라도 상관없는 'Schemaless' 구조다.
  - Attribute (속성): RDS의 열(Column)에 해당한다.
  - Primary Key (기본 키): 데이터를 고유하게 식별한다. 두 가지 방식이 존재한다.
    - Partition Key (PK): 내부 해시 함수에 입력되어 데이터를 저장할 물리적 파티션을 결정한다.
    - Sort Key (SK): 동일한 PK 내에서 데이터를 정렬한다. PK와 SK를 조합하여 복합키(Composite Key)를 형성할 수 있다.
- 핵심 특징: 성능과 확장성
  - 읽기/쓰기 용량 모드
    - On-demand (온디맨드): 워크로드를 예측할 수 없을 때 사용한다. 사용한 만큼 비용을 지불하며 자동으로 확장된다.
    - Provisioned (프로비저닝됨): 초당 읽기/쓰기 유닛(RCU/WCU)을 미리 지정한다. 트래픽이 일정할 때 비용 효율적이며 오토 스케일링을 지원한다.
  - 데이터 일관성 (Consistency)
    - 최종 일관성 (Eventually Consistent): 기본 설정이다. 읽기 성능이 가장 좋지만, 직전에 쓴 데이터가 즉시 반영되지 않을 수 있다.
    - 강력한 일관성 (Strongly Consistent): 최신 데이터를 보장하지만 지연 시간이 늘어날 수 있고 RCU 소모량이 2배다.
  - 보조 인덱스 (Secondary Indexes)
    - 기본 키 외에 다른 속성으로 데이터를 조회하기 위해 사용한다.
    - LSI (Local Secondary Index): PK는 같지만 SK가 다른 인덱스다. 테이블 생성 시에만 만들 수 있다.
    - GSI (Global Secondary Index): PK와 SK가 모두 다른 새로운 인덱스다. 언제든지 생성 및 삭제가 가능하다.
- 고급 기능
  - DynamoDB Streams: 테이블의 데이터 변경(추가, 수정, 삭제) 이벤트를 실시간으로 캡처한다. 주로 Lambda와 연동하여 데이터 변경에 따른 후속 작업을 자동화한다.
  - TTL (Time to Live): 특정 시간이 지나면 항목을 자동으로 삭제한다. 세션 관리나 로그 저장에 유용하며 추가 비용이 없다.
  - DAX (DynamoDB Accelerator): 읽기 성능을 마이크로초 단위까지 끌어올리기 위한 인메모리 캐시 서비스다.


## API Gateway

- 활용 구조
![구조](/assets/images/APIGateway.png)

- 개발자가 어떤 규모에서든 API를 간편하게 생성, 게시, 유지 관리, 모니터링 및 보안을 유지할 수 있도록 돕는 완전 관리형 서비스다.
- 핵심 작동 원리: 트래픽의 입구
  - 클라이언트 요청: 사용자가 HTTPS 프로토콜을 통해 API 엔드포인트로 요청을 보낸다.
  - 보안 및 검증: API Gateway가 API 키 확인, 인증(Cognito, Lambda Authorizer), 권한 부여 및 속도 제한(Throttling)을 수행한다.
  - 요청 변환 (Mapping): 클라이언트가 보낸 데이터를 백엔드가 이해할 수 있는 형식으로 변환한다.
  - 백엔드 호출: Lambda, EC2, DynamoDB 또는 다른 HTTP 엔드포인트로 요청을 보낸다.
  - 응답 반환: 백엔드의 결과를 다시 클라이언트가 요구하는 형식으로 변환하여 전달한다.

- API Gateway 캐시: API 응답 / CloudFront 캐시: HTTP 콘텐츠 전체
## Amazon Cognito

- 웹 및 모바일 애플리케이션에 대한 인증(Authentication), 권한 부여(Authorization) 및 사용자 관리 기능을 쉽고 빠르게 구현할 수 있게 해주는 완전 관리형 서비스다.
- 핵심 구성 요소: User Pools vs Identity Pools
  - Cognito는 크게 두 가지 서비스로 나뉘며, 이 둘의 차이를 명확히 구분하는 것이 SAA 시험과 실무 설계의 핵심이다.
  - User Pools (사용자 풀)
    - 역할: 인증(Authentication) 담당.
    - 기능: 사용자의 가입, 로그인, 프로필 관리, MFA(다중 인증)를 처리한다.
    - 특징: 로그인에 성공하면 JSON Web Token(JWT)을 반환한다. 
    - 자체 사용자 디렉터리를 가질 수도 있고, Google, Facebook, Apple과 같은 소셜 로그인이나 SAML/OIDC 기반의 기업용 로그인과 연동할 수 있다.
    - 주 용도: "우리 서비스의 회원이 맞는지" 확인하는 과정.
  - Identity Pools (자격 증명 풀)
    - 역할: 권한 부여(Authorization) 담당.
    - 기능: 사용자에게 S3, DynamoDB와 같은 AWS 리소스에 접근할 수 있는 임시 자격 증명(IAM Role)을 부여한다.
    - 인증된 사용자(User Pool 통과자 등)뿐만 아니라 인증되지 않은 게스트 사용자에게도 제한된 권한을 줄 수 있다.
    - 주 용도: "이 사용자가 S3 버킷에 파일을 업로드할 권한이 있는지" 결정하는 과정.
- 주요 활용 시나리오 (Use Cases)
  - 서버리스 앱 인증 (API Gateway 연동)
    - 사용자가 Cognito User Pool을 통해 로그인하고 받은 JWT 토큰을 API Gateway에 전달하면, API Gateway가 이 토큰의 유효성을 검사하여 백엔드 Lambda 함수를 실행시킨다.
  - 클라이언트의 AWS 리소스 직접 접근
    - 모바일 앱 사용자가 사진을 업로드할 때, 백엔드 서버를 거치지 않고 Identity Pool로부터 받은 임시 권한을 사용해 S3 버킷에 직접 업로드하게 설계함으로써 서버 부하를 줄인다.


## Serverless 사용 아키텍처들

![구조](/assets/images/ThumbnailFlow.png)

![구조](/assets/images/UserWelcomeFlow.png)
![구조](/assets/images/CachingAPIGateway.png)



## DocumentDB, Neptune, Keyspaces(for Apache Cassandra)

- Document DB : MongoDB 호환 문서형(NoSQL) 데이터베이스
- Neptune : 그래프(Graph) 데이터베이스
- Keyspaces : Apache Cassandra 호환 Key-Value / Wide-column DB